<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>출석 코드 입력</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
<div class="container">
    <div class="title">출석 코드 입력</div>
    <div class="subtitle">수업을 선택한 뒤, 출석 코드를 입력하세요.</div>

    <form method="post" action="/student/attend">
        <!-- 이름 -->
        <div class="label">이름</div>
        <input
            class="input-box"
            name="student_name"
            placeholder="이름을 입력하세요"
            required
        >

        <!-- 수업 선택 -->
        <div class="label" style="margin-top: 14px;">수업 선택</div>
        <select class="input-box" name="session_date" required>
            {% if sessions and sessions|length > 0 %}
                <option value="">수업(날짜)을 선택하세요</option>
                {% for s in sessions %}
                    <option value="{{ s.session_date }}">
                        {{ s.session_date }} (유효 종료: {{ s.end_str }})
                    </option>
                {% endfor %}
            {% else %}
                <option value="">현재 유효한 출석 코드가 있는 수업이 없습니다</option>
            {% endif %}
        </select>

        <!-- 출석 코드 -->
        <div class="label" style="margin-top: 14px;">출석 코드 (6자리)</div>
        <input
            class="input-box"
            name="attendance_code"
            maxlength="6"
            placeholder="123456"
            required
        >

        <div class="info-box">
            교수님이 제시한 6자리 출석 코드를 입력하세요.
        </div>

        <div class="warn-box">
            ⚠ 교내 Wifi로 출석하지 않을 시 재출결이 필요할 수 있습니다.
        </div>

        <!-- ✅ 이미 출석한 경우 버튼 비활성화 -->
        <button
            class="button-main {% if already_attended %}button-disabled{% endif %}"
            type="submit"
            {% if already_attended %}disabled{% endif %}
        >
            출석 체크
        </button>

        {% if already_attended %}
            <div class="info-box already-box">
                이미 이 수업에 출석하셨습니다.
            </div>
        {% endif %}
    </form>

    {% if result %}
        <div class="result-box">
            {{ result }}<br>
            {% if ip_status_message %}
                <span>{{ ip_status_message }}</span>
            {% endif %}
        </div>
    {% endif %}
</div>
</body>
</html>